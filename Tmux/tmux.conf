###
# Look & Feel
###
set -g status on
set -g status-bg colour235
set -g status-attr default
set -g status-interval 2
set -g status-justify centre
set -g status-keys vi
set -g status-left "#[bold]#{?client_readonly,#[fg=colour160][RO] ,}#{?client_prefix,#[fg=colour64],#[fg=colour160]}#S#{?session_many_attached,#[fg=default]+,}"
set -g status-left-attr none
set -g status-left-length 20
set -g status-position top
set -g status-right "#[fg=colour136]#(uptime|egrep -o '(\d+\.\d\d ?){3}') #[fg=colour245]| #[fg=colour37]#(date +%Y-%m-%d) #[fg=colour245]| #[fg=colour37]#(date +%H:%M) #[fg=colour245]| #[fg=colour64]#h"
set -g status-right-attr none
set -g status-right-bg colour235 #base02
set -g status-right-fg colour136 #yellow
set -g status-right-length 150
set -g status-left-style default
set -g status-right-style default

# default window title colors
setw -g window-status-fg colour224 #base0
setw -g window-status-bg default
setw -g window-status-format "#I:#W#F"
setw -g window-status-attr dim

# last window title colors
#setw -g window-status-last-fg colour224 #base0
#setw -g window-status-last-bg default
#setw -g window-status-last-attr bright

# active window title colors
setw -g window-status-current-fg colour166 #orange
setw -g window-status-current-bg default
setw -g window-status-current-attr dim
setw -g window-status-current-format "#I:#W#F"
setw -g window-status-current-attr default

# pane border
set -g pane-border-fg colour234 #base02
set -g pane-border-bg default
set -g pane-active-border-fg colour240 #base01
set -g pane-active-border-bg default

# command line/message text
set -g message-bg colour234 #base02
set -g message-fg colour166 #orange

# pane number display
set -g display-panes-active-colour colour245 #blue
set -g display-panes-colour colour166 #orange

# clock
setw -g clock-mode-colour colour64 #green

###
# set-option options
###
set-option -s escape-time 0
set-option -g prefix "M-/"
set-option -g base-index 0
set-option -g default-terminal "screen-256color"
set-option -g visual-activity off
set-option -g visual-bell on
set-option -g set-titles on
set-option -g set-titles-string '#S'
set-option -g destroy-unattached on
set-window-option -g aggressive-resize on
set-window-option -g allow-rename on
set-window-option -g automatic-rename on
set-window-option -g automatic-rename-format "#{?pane_in_mode,[tmux],#{pane_title}}#{?pane_dead,[dead],}"
set-window-option -g mode-keys vi
set-window-option -g clock-mode-style 24
set-window-option -g monitor-activity on
set-window-option -g xterm-keys

###
# Key Bindings
###
unbind-key -a          #       Clear all bindings
bind-key               'd'     detach-client
bind-key               'D'     set destroy-unattached
bind-key -T vi-copy    'v'     begin-selection
bind-key -T vi-copy    'y'     copy-selection
bind-key -T emacs-copy 'C-w'   copy-selection -x
bind-key -T emacs-copy 'C-q'   copy-pipe "cat >/tmp/out"
bind-key               '/'     send-prefix
bind-key               't'     choose-tree -u
bind-key               's'     choose-session
bind-key               'S'     switch-client -l
bind-key               'M-s'   set -q status
bind-key               'w'     choose-window
bind-key               'M-/'   last-window
bind-key               '['     copy-mode
bind-key               ']'     paste-buffer
bind-key -r            'n'     next-window
bind-key -r            'p'     previous-window
bind-key -r            '<'     swap-window -t -1
bind-key -r            '>'     swap-window -t +1
bind-key               'h'     select-pane -L
bind-key               'j'     select-pane -D
bind-key               'k'     select-pane -U
bind-key               'l'     select-pane -R
bind-key -r            'H'     resize-pane -L 5
bind-key -r            'J'     resize-pane -D 5
bind-key -r            'K'     resize-pane -U 5
bind-key -r            'L'     resize-pane -R 5
bind-key -r            'C-j'   swap-pane -D
bind-key -r            'C-k'   swap-pane -U
bind-key -r            'M-j'   swap-pane -Dd
bind-key -r            'M-k'   swap-pane -Ud
bind-key -r            'space' next-layout
bind-key               '~'     new-session
bind-key               '$'     set destroy-unattached off \; command-prompt -p 'Session Name:' 'rename-session "%1"'
bind-key               'M-$'   command-prompt -p 'Session Name:' 'new-session -s "%1"'
bind-key               '%'     new-window
bind-key               '&'     command-prompt -p 'Window Name:' 'rename-window "%1"'
bind-key               'M-&'   command-prompt -p 'Window Name:' 'new-window -n "%1"'
bind-key               'R'     command-prompt -p 'Run:,Window Name:' 'new-window -n "%2" "%1"'
bind-key               'g'     command-prompt -p 'Host:' 'new-window -n "SSH: %1" "ssh %1"'
bind-key               'c'     new-window -n "Capacity Server" "ssh capacity@cap"
bind-key               ':'     command-prompt
bind-key               '!'     confirm-before -p 'Kill pane?' kill-pane
bind-key               'C-l'   run "tmux send-keys C-l; tmux clearhist -t #{pane_id}"
bind-key               'M-e'   new-window -n 'Tmux Config' '$EDITOR ~/.tmux.conf && tmux source-file ~/.tmux.conf'
bind-key               'r'     source-file ~/.tmux.conf \; display-message 'Config reloaded'
bind-key               'z'     resize-pane -Z
bind-key               'm'     new-window -n 'Mutt' 'mutt'
bind-key               '|'     split-window -h -c "#{pane_current_path}"
bind-key               '='     split-window -v -c "#{pane_current_path}"
bind-key               'C-c'   run 'tmux save-buffer - | xsel'
bind-key               'C-v'   run 'tmux set-buffer "$(xsel)"'
bind-key               'u'     capture-pane \; save-buffer /tmp/tmux-buffer \; new-window -n "urlview" '$SHELL -c "urlview < /tmp/tmux-buffer"'
bind-key               'C-t'   run "tmux send-keys $(stoken) Enter"
bind-key               '?'     list-keys
bind-key               'C-P'   command-prompt -p 'save history to filename:' -I '~/' 'capture-pane -S - ; save-buffer %1 ; delete-buffer'
bind-key               'M-u'   run-shell "${HOME}/.config/Tmux/plugins/tmux-copycat/scripts/copycat_mode_start.sh '[[:xdigit:]]{8}-([[:xdigit:]]{4}-){3}[[:xdigit:]]{12}'"

###
# Load Plugins
###
run-shell '~/.config/Tmux/plugins/load_all.zsh'
